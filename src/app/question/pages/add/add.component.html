<h1 mat-dialog-title 
    style="text-align: center;">
        Agregar Pregunta
</h1>

<div mat-dialog-content>

    <form [formGroup]="formQuestion">

        <mat-grid-list cols="1" rowHeight="90px">
            <mat-grid-tile>
                <mat-form-field appearance="outline">
                    <mat-label>Descripción</mat-label>
                    <input 
                        type="text"
                        matInput
                        formControlName="description"
                        placeholder="Descripción"
                        autocomplete="off">
                        <mat-error 
                            *ngIf="formQuestion.get('description')?.touched &&
                                   formQuestion.get('description')?.errors?.['required']">
                                   <span>Descripción es requerida</span>
                        </mat-error>

                        <mat-error 
                            *ngIf="formQuestion.get('description')?.touched &&
                                   formQuestion.get('description')?.hasError?.('maxlength')">
                                   <span>Valor máximo permitido 120 carácter</span>
                        </mat-error>
                </mat-form-field>
            </mat-grid-tile>
        </mat-grid-list>

        <mat-grid-list cols="1" rowHeight="90px">
            <mat-grid-tile>
                <mat-form-field appearance="outline">
                    <mat-label>Puntuación de la pregunta</mat-label>
                    <input 
                        type="text"
                        matInput
                        formControlName="puntuation"
                        placeholder="Puntuación de la pregunta"
                        autocomplete="off">
                        <mat-error 
                            *ngIf="formQuestion.get('puntuation')?.touched &&
                                   formQuestion.get('puntuation')?.errors?.['required']">
                                   <span>Puntuación es requerida</span>
                        </mat-error>

                        <mat-error 
                            *ngIf="formQuestion.get('puntuation')?.touched &&
                                   formQuestion.get('puntuation')?.errors?.['pattern']">
                                   <span>Este campo solo permite números</span>
                        </mat-error>
                </mat-form-field>
            </mat-grid-tile>
        </mat-grid-list>

        <app-filter-skill [question]="question" (questionModified)="receiveModifiedQuestion($event)"></app-filter-skill>
        
        <mat-grid-list cols="2" rowHeight="90px">
            <mat-grid-tile>
                <button
                    type="button"
                    class="btn btn-dark form-control"
                    (click)="ImgInputAnswer.click()"
                    >
                        Subir Imagen
                    <i class="material-icons right">
                        add_a_photo
                    </i>
                </button>
            </mat-grid-tile>
            
            <mat-grid-tile>
                <div class="row">
                    <input
                      type="file"
                      formControlName="photoQuestion"
                      hidden
                      #ImgInputAnswer
                      (change)="captureImg($event)"
                    />

                    <div *ngIf="previewImg" class="row">
                        <div class="row m-3">
                          <img width="120px" [src]="previewImg"/>
                        </div>
                    </div>
                </div>
            </mat-grid-tile>
        </mat-grid-list>

        <mat-grid-list cols="1" rowHeight="90px">
            <mat-grid-tile>
                <div class="mt-3 row" formArrayName="answers" 
                    *ngFor="let ans of getAnswers.controls; let pointIndex=index"
                    [formGroupName]="pointIndex">
                        <mat-form-field class="col-10" appearance="outline">
                            <mat-label>Ingrese respuesta</mat-label>
                                <input 
                                matInput
                                formControlName="answer"
                                placeholder="Respuesta"
                                autocomplete="off"
                            >  
                </mat-form-field>
                </div> 
                    <button
                        type="button"
                        class="btn btn-dark"  
                        (click)="addInputAnswer()">add
                    </button>
            </mat-grid-tile>
        </mat-grid-list>        

        <!-- <mat-grid-list cols="1" rowHeight="90px">
            <mat-grid-tile>
              <div class="mt-3">
                <div formArrayName="answers">
                  <div *ngFor="let ans of getAnswers.controls; let pointIndex=index" [formGroupName]="pointIndex">
                    <mat-form-field appearance="outline">
                      <mat-label>Ingrese respuesta</mat-label>
                      <input matInput formControlName="answer" placeholder="Respuesta" autocomplete="off">
                    </mat-form-field>
                  </div>
                </div>
                <div>
                  <button (click)="addInputAnswer()">add</button>
                </div>
              </div>
            </mat-grid-tile>
          </mat-grid-list> -->
    </form>
</div>

<div mat-dialog-actions>
    <button
        mat-raised-button
        class="botonGuardar"
        (click)="AddQuestion()"
        [disabled]="formQuestion.invalid || question.skillList.length < 1" 
    >
        Guardar
    </button>

    <button
        class="botonVolver"
        mat-raised-button
        mat-dialog-close
    >
        Volver
    </button>
</div>